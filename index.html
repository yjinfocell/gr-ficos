<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard â€“ Vendas por Vendedor FILIAL</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{
      --bg:#0f172a;
      --panel:#111827;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --accent:#22c55e;
      --accent2:#3b82f6;
      --warn:#f59e0b;
      --danger:#ef4444;
      --card:#0b1220;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:linear-gradient(180deg, var(--bg), #020617);
      color:var(--text); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    header{
      padding:20px; display:flex; gap:12px; align-items:center; justify-content:space-between; border-bottom:1px solid #1f2937; position:sticky; top:0; background:rgba(2,6,23,.8); backdrop-filter: blur(6px); z-index:10;
    }
    header h1{font-size:20px; margin:0; font-weight:600}
    .wrap{display:grid; grid-template-columns:320px 1fr; min-height:calc(100vh - 64px)}
    @media (max-width: 1024px){ .wrap{grid-template-columns:1fr} }
    aside{
      border-right:1px solid #1f2937; padding:16px; max-height:calc(100vh - 64px); overflow:auto; background:rgba(2,6,23,.6);
    }
    .search{
      width:100%; padding:10px 12px; background:#0b1220; border:1px solid #1f2937; border-radius:10px; color:var(--text);
      outline:none; margin-bottom:12px;
    }
    .vendor{
      display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; cursor:pointer; color:#cbd5e1; border:1px solid transparent;
    }
    .vendor:hover{ background:#0b1220; border-color:#1f2937 }
    .vendor.active{ background:#0b1220; border-color:#334155; color:#fff }
    .pill{margin-left:auto; font-size:12px; padding:2px 8px; border-radius:999px; background:#0b1220; border:1px solid #1f2937; color:#a3e635}

    main{ padding:18px; }
    .panel{ background:linear-gradient(180deg, var(--panel), #0b1220); border:1px solid #1f2937; border-radius:16px; padding:16px; }
    .title{ display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:space-between; margin-bottom:10px }
    .title h2{ margin:0; font-size:18px }

    .grid{ display:grid; grid-template-columns:1fr; gap:16px }
    @media (min-width: 900px){ .grid{ grid-template-columns: 1fr 1fr } }

    .table{ width:100%; border-collapse:collapse; margin-top:10px; font-size:14px }
    .table th,.table td{ border-bottom:1px dashed #1f2937; padding:10px 8px; text-align:left }
    .table th{ color:#cbd5e1; font-weight:600 }
    .badge{ font-size:12px; padding:3px 8px; border:1px solid #1f2937; border-radius:999px; background:#0b1220 }

    .totals{ display:flex; gap:10px; flex-wrap:wrap }
    .kpi{ flex:1 1 180px; background:#0b1220; border:1px solid #1f2937; border-radius:12px; padding:10px }
    .kpi .k{ color:var(--muted); font-size:12px }
    .kpi .v{ font-weight:700; font-size:18px }

    footer{ color:#64748b; font-size:12px; text-align:center; padding:14px }
    .hint{ color:#94a3b8; font-size:12px }
    .note{ font-size:12px; color:#a3a3a3 }

    .status-pago{ color: var(--accent); font-weight: bold; }
    .status-nao{ color: var(--danger); font-weight: bold; }

    .panel canvas { max-height: 300px; width: 100% !important; }
  </style>
</head>
<body>
  <header>
    <h1>Dashboard â€“ Vendas por Vendedor FILIAL</h1>
    <div class="hint">Clique em um vendedor para visualizar os grÃ¡ficos e as tabelas.</div>
  </header>

  <div class="wrap">
    <aside>
      <input id="search" class="search" placeholder="Buscar vendedor..." />
      <div id="vendorList"></div>
    </aside>
    <main>
      <div class="panel">
        <div class="title">
          <h2 id="sellerName">Selecione um vendedor</h2>
          <span id="periodBadge" class="badge">PerÃ­odo: Jan â†’ Ago (atÃ© 13/08)</span>
        </div>

        <div class="totals" id="totals"></div>

        <div class="grid">
          <div class="panel">
            <div class="title"><h2>Atacado</h2><span class="badge">Barras = Vendas â€¢ Linha = Recompensa</span></div>
            <canvas id="chartAtacado"></canvas>
            <table class="table" id="tableAtacado"></table>
          </div>
          <div class="panel">
            <div class="title"><h2>Varejo</h2><span class="badge">Barras = Vendas â€¢ Recompensa</span></div>
            <canvas id="chartVarejo"></canvas>
            <table class="table" id="tableVarejo"></table>
          </div>
        </div>
        <div class="note" style="margin-top:10px">FormataÃ§Ã£o em R$ (pt-BR). Meses sem valor informado foram considerados 0.</div>
      </div>
    </main>
  </div>

  <footer>
    Feito com Chart.js â€¢ PÃ¡gina Ãºnica (sem servidor)
  </footer>

  <script>
    const MESES = ["JANEIRO","FEVEREIRO","MARÃ‡O","ABRIL","MAIO","JUNHO","JULHO","AGOSTO"];
    const Z = (arr) => MESES.map((_, i) => arr[i] ?? 0);
    const fmtBRL = (n) => (n||0).toLocaleString('pt-BR', { style:'currency', currency:'BRL' });

    const vendedoresRaw = {
      "ALEXANDRE LOPES": {
        varejo: Z([3770,1140,3148.8,2607,3225,7164,4740,1300]),
        atacado: Z([196964.7,153782.56,165504.9,185143.35,214774.85,189859.26,266051.33,204776.46]),
        faixaAtacado: Z(["0","0","0","0","0","R$ 176.000 a R$ 215.000","R$ 246.000 a R$ 275.000","R$ 176.000 a R$ 215.000"]),
        faixaVarejo: Z(["R$ 3.000 a R$ 4.000","R$ 1.000 a R$ 2.000","R$ 3.000 a R$ 4.000","R$ 2.000 a R$ 3.000","R$ 3.000 a R$ 4.000","R$ 7.000 a R$ 8.000","R$ 4.000 a R$ 5.000","R$ 1.000 a R$ 2.000"]),
        recompensaAtacado: Z([0,0,0,0,0,1100,1375,1100]),
        recompensaVarejo: Z([50,30,50,40,50,100,70,30]),
        statusAtacado: Z(["Pago","Pago","NÃ£o pago","NÃ£o pago","NÃ£o pago","Pago","Pago","Pago"]),
        statusVarejo: Z(["Pago","NÃ£o pago","Pago","Pago","NÃ£o pago","Pago","Pago","NÃ£o pago"])
      },
      "FELIPE HENRIQUE": {
        varejo: Z([5302,860,1198,3971,4454,6237,6377,923]),
        atacado: Z([100397.1,100097.7,38896.42,96242.9,96510.3,101409.5,110261.8,19503.3]),
        faixaAtacado: Z(["0","0","0","0","0","R$ 86.000 a R$ 115.000","R$ 86.000 a R$ 115.000","0"]),
        faixaVarejo: Z(["R$ 5.000 a R$ 6.000","R$ 0 a R$ 1.000","R$ 1.000 a R$ 2.000","R$ 3.000 a R$ 4.000","R$ 4.000 a R$ 5.000","R$ 6.000 a R$ 7.000","R$ 6.000 a R$ 7.000","R$ 0 a R$ 1.000"]),
        recompensaAtacado: Z([0,0,0,0,0,400,400,0]),
        recompensaVarejo: Z([60,0,20,40,50,70,70,10]),
        statusAtacado: Z(["NÃ£o pago","NÃ£o pago","NÃ£o pago","Pago","Pago","Pago","Pago","NÃ£o pago"]),
        statusVarejo: Z(["Pago","Pago","NÃ£o pago","Pago","Pago","Pago","Pago","NÃ£o pago"])
      }
    };

    const vendedores = Object.keys(vendedoresRaw).sort((a,b)=> a.localeCompare(b,'pt-BR',{sensitivity:'base'}));
    const vendorListEl = document.getElementById('vendorList');
    const searchEl = document.getElementById('search');
    const sellerNameEl = document.getElementById('sellerName');
    const chAt = document.getElementById('chartAtacado');
    const chVr = document.getElementById('chartVarejo');
    const tableAtEl = document.getElementById('tableAtacado');
    const tableVrEl = document.getElementById('tableVarejo');
    const totalsEl = document.getElementById('totals');
    let chartAt = null, chartVar = null, activeItem = null;

    // ----------------------- Render Lista de Vendedores -----------------------
    function renderVendorList(filter = ''){
      vendorListEl.innerHTML = '';
      const f = filter.trim().toLowerCase();
      vendedores.forEach(name => {
        if(f && !name.toLowerCase().includes(f)) return;
        const li = document.createElement('div');
        li.className = 'vendor';
        li.innerHTML = `<span>ðŸ‘¤</span><span>${name}</span>`;
        li.onclick = ()=> selectVendor(name, li);
        vendorListEl.appendChild(li);
      });
    }
    searchEl.addEventListener('input', e => renderVendorList(e.target.value));
    renderVendorList('');

    // ----------------------- Totais -----------------------
    function buildTotals(v){
      const totVar = v.varejo.reduce((a,b)=>a+(b||0),0);
      const totAta = v.atacado.reduce((a,b)=>a+(b||0),0);
      const totRecAta = v.recompensaAtacado.reduce((a,b)=>a+(b||0),0);
      const totRecVar = v.recompensaVarejo.reduce((a,b)=>a+(b||0),0);
      totalsEl.innerHTML = `
        <div class="kpi"><div class="k">Total Varejo</div><div class="v">${fmtBRL(totVar)}</div></div>
        <div class="kpi"><div class="k">Total Atacado</div><div class="v">${fmtBRL(totAta)}</div></div>
        <div class="kpi"><div class="k">Total Recompensa Atacado</div><div class="v">${fmtBRL(totRecAta)}</div></div>
        <div class="kpi"><div class="k">Total Recompensa Varejo</div><div class="v">${fmtBRL(totRecVar)}</div></div>
      `;
    }

    // ----------------------- Charts -----------------------
    function buildAtacadoChart(ctx, meses, vendas, recompensa){
      if(chartAt) chartAt.destroy();
      chartAt = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: meses,
          datasets: [
            { label: 'Vendas Atacado', data: vendas, backgroundColor:'rgba(59,130,246,0.7)', borderColor:'rgba(59,130,246,1)', borderWidth:1, yAxisID:'y' },
            { label: 'Recompensa', data: recompensa, type:'line', borderColor:'rgba(239,68,68,1)', backgroundColor:'rgba(239,68,68,0.25)', borderWidth:2, pointRadius:3, tension:.25, yAxisID:'y1' }
          ]
        },
        options: {
          responsive:true,
          maintainAspectRatio:true,
          aspectRatio:2,
          interaction:{ mode:'index', intersect:false },
          plugins:{ legend:{ labels:{ color:'#e5e7eb' } }, tooltip:{ callbacks:{ label:(ctx)=>`${ctx.dataset.label}: ${fmtBRL(ctx.raw)}` } } },
          scales:{
            x:{ ticks:{ color:'#cbd5e1' }, grid:{ color:'rgba(148,163,184,0.1)' } },
            y:{ position:'left', ticks:{ color:'#cbd5e1', callback:(v)=>fmtBRL(v) }, grid:{ color:'rgba(148,163,184,0.1)' } },
            y1:{ position:'right', grid:{ drawOnChartArea:false }, ticks:{ color:'#cbd5e1', callback:(v)=>fmtBRL(v) } }
          }
        }
      });
    }

    function buildVarejoChart(ctx, meses, vendas){
      if(chartVar) chartVar.destroy();
      chartVar = new Chart(ctx, {
        type:'bar',
        data:{
          labels:meses,
          datasets:[{ label:'Vendas Varejo', data:vendas, backgroundColor:'rgba(34,197,94,0.75)', borderColor:'rgba(34,197,94,1)', borderWidth:1 }]
        },
        options:{
          responsive:true,
          maintainAspectRatio:true,
          aspectRatio:2,
          plugins:{ legend:{ labels:{ color:'#e5e7eb' } }, tooltip:{ callbacks:{ label:(ctx)=>`${ctx.dataset.label}: ${fmtBRL(ctx.raw)}` } } },
          scales:{ x:{ ticks:{ color:'#cbd5e1' }, grid:{ color:'rgba(148,163,184,0.1)' } }, y:{ ticks:{ color:'#cbd5e1', callback:(v)=>fmtBRL(v) }, grid:{ color:'rgba(148,163,184,0.1)' } } }
        }
      });
    }

    // ----------------------- Tabelas -----------------------
    function buildAtacadoTable(meses, vendas, faixa, recompensa, status){
      let html = `<thead><tr><th>MÃªs</th><th>Vendas Atacado</th><th>Faixa</th><th>Recompensa</th><th>Status</th></tr></thead><tbody>`;
      meses.forEach((m,i)=>{
        const f = faixa[i]==="0"?"-":faixa[i];
        const stClass = status[i]==="Pago"?"status-pago":"status-nao";
        html += `<tr><td>${m}</td><td>${fmtBRL(vendas[i]||0)}</td><td>${f}</td><td>${fmtBRL(recompensa[i]||0)}</td><td class="${stClass}">${status[i]}</td></tr>`;
      });
      html += `</tbody>`;
      tableAtEl.innerHTML = html;
    }

    function buildVarejoTable(meses, vendas, faixa, recompensa, status){
      let html = `<thead><tr><th>MÃªs</th><th>Vendas Varejo</th><th>Faixa</th><th>Recompensa</th><th>Status</th></tr></thead><tbody>`;
      meses.forEach((m,i)=>{
        const f = faixa[i]==="0"?"-":faixa[i];
        const stClass = status[i]==="Pago"?"status-pago":"status-nao";
        html += `<tr><td>${m}</td><td>${fmtBRL(vendas[i]||0)}</td><td>${f}</td><td>${fmtBRL(recompensa[i]||0)}</td><td class="${stClass}">${status[i]}</td></tr>`;
      });
      html += `</tbody>`;
      tableVrEl.innerHTML = html;
    }

    // ----------------------- SeleÃ§Ã£o de vendedor -----------------------
    function selectVendor(name, el){
      if(activeItem) activeItem.classList.remove('active');
      if(el){ activeItem = el; activeItem.classList.add('active'); }
      sellerNameEl.textContent = name;
      const v = vendedoresRaw[name];
      buildTotals(v);
      buildAtacadoChart(chAt.getContext('2d'), MESES, v.atacado, v.recompensaAtacado);
      buildVarejoChart(chVr.getContext('2d'), MESES, v.varejo);
      buildAtacadoTable(MESES, v.atacado, v.faixaAtacado, v.recompensaAtacado, v.statusAtacado);
      buildVarejoTable(MESES, v.varejo, v.faixaVarejo, v.recompensaVarejo, v.statusVarejo);
    }

    // Seleciona automaticamente o primeiro vendedor
    const firstVendor = vendorListEl.querySelector('.vendor');
    if(firstVendor){ firstVendor.click(); }
  </script>
</body>
</html>
